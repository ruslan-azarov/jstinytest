<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script src="../tinytest.js"></script>
  <script>
    // Example 1: It should run array.length times.
    // filter([1,2,3], function() {});

    // Example 2: Callback should have access to element.
    // filter([1,2,3], function (num) {
    //   console.log(num);
    // })

    // Example 3: Callback should have access to index.
    // filter([1,2,3], function (num, index) {
    //   console.log(index)
    // })

    // Example 4: Callback should have access to the originalArray.
    // filter([1,2,3], function (num, index, originalArray) {
    //   console.log(originalArray)
    // })

    // Example 5: 'configurableThis' should work.
    // filter([1,2,3], function() {
    //   console.log(this.name);
    // }, {name: Ruslan});

    // Example 6: 'filter' should return a different array without modifying original array.
    // var testArray = [1,2,3];
    // var filteredArray = filter(testArray, function() {});
    // testArray !== filteredArray

    // Example 7: Testing the 'filtering' functionality.
    // var testArray = [1,2,3];
    // var filteredArray = filter(testArray, function (element, index, array) {
    //   return element > 1;
    // });
    // Expect filteredArray to be [2, 3]


    function filter(array, callback, optionalThisObject) {
      var filterCallback = callback;
      
      if (optionalThisObject) {
        filterCallback = callback.bind(optionalThisObject);
      } 

      var filteredArray = []

      for (var i = 0; i < array.length; i++) {
        if(filterCallback(array[i], i, array)) {
          filteredArray.push(array[i]);
        }
      }

      return filteredArray;
    }

    tests({
      'It should run the callback function array.length times.': function() {
        var counter = 0;
        filter([1,2,3], function() {
          counter++;
        });
        eq(counter, 3);
      },
      'It should pass in the ith element as the first argument to the callback.': function() {
        filter([1], function(num) {
          eq(num, 1);
        });
      },
      'It should pass in the ith position as the second argument to the callback.': function() {
        filter([1], function (num, index) {
          eq(index, 0);
        })
      },
      'It should pass in the originalArray as the third argument to the callback.': function() {
        var array = [];
        filter(array, function (num, index, originalArray) {
          eq(originalArray, array);
        })
      },
      'It should accept an optional this object.': function() {
        filter([1], function() {
          eq(this.description, 'I am an optionalThisObject');
        }, {description: 'I am an optionalThisObject'});
      },
      'It should return an array': function() {
        var filteredArray = filter([], function() {});
        eq(Array.isArray(filteredArray), true);

      },
      'It should return a new array, not the array being filtered.': function() {
        var arrayBeingFiltered = [];
        var filteredArray = filter(arrayBeingFiltered, function() {});
        eq(filteredArray !== arrayBeingFiltered, true);
      }, 
      'It should return a new array that only has elements where callback returns true.': function() {
        var filteredArray = filter([1,2], function(num) {
          return num > 1;
        });
        eq(filteredArray.length, 1);
        eq(filteredArray[0], 2);
      }
    });
  </script>
  
</body>
</html>